{% extends "base.html" %}
{% set active_page = 'books' %}
{% set header_class = 'bg-success-subtle border-bottom border-success' %}
{% block title %}Book Details â€“ SG Library{% endblock %}
{% block page_title %}BOOK DETAILS{% endblock %}

{% block content %}
<div class="py-4">
  <div class="container">

    <div class="card book-card">
      <div class="card-body">
        <div class="row g-3 align-items-start">
          <div class="col-auto">
            <img src="{{ b.url }}" alt="{{ b.title }} cover" class="cover img-fluid">
          </div>
          <div class="col">
            <h4 class="mb-1">{{ b.title }}</h4>
            <div class="text-muted mb-2">By {{ b.authors|join(', ') }}</div>

            <div class="small text-muted mb-2">
              Category: {{ b.category }}{% if b.genres %}, {{ b.genres|join(', ') }}{% endif %}<br>
              Pages: {{ b.pages }}<br>
              Copies: {{ b.copies }} &nbsp; Available: <strong>{{ b.available }}</strong>
            </div>

            {% if b.description %}
              {% for para in b.description %}
                <p class="mb-3">{{ para }}</p>
              {% endfor %}
            {% endif %}
          </div>
        </div>
      </div>
      <div class="card-footer bg-transparent border-0 pt-0">
        <div class="d-flex justify-content-end">
          <a href="{{ url_for('books.book_titles') }}" class="btn btn-success btn-sm">Back to Book Titles</a>
      
          {% if b.available|int > 0 %}
            <form method="post" action="{{ url_for('books.make_loan', title=b.title) }}" class="d-inline ms-2">
              <button class="btn btn-success btn-sm" type="submit">Make a Loan</button>
            </form>
          {% else %}
            <span class="btn btn-danger btn-sm disabled ms-2">Not Available</span>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
